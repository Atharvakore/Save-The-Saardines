@startuml
participant "sim:Simulator" as s
participant "c1:Corporation" as c1
participant "s1:ScoutingShip" as scouting
participant "s2:CollectingShip" as collecting
participant "m:Map" as m
participant "t66:DeepOcean" as t66
participant "oil:Garbage" as oil
participant "current:Current" as current
participant "t67:DeepOcean" as t67




activate s

s -> s: tick()
activate s

s -> s: runCorporations()
activate s

s -> c1: moveShips()
activate c1

c1 -> scouting: getTilesWithGarbageInFoV()
activate scouting

scouting --> c1: List<Tile>

c1 -> collecting: getTilesWithGarbageInFoV()
activate collecting

collecting --> c1: List<Tile>
deactivate collecting

c1 -> scouting: navigateTo(t66)
scouting --> c1
deactivate scouting


c1 --> s
deactivate c1


s -> c1: collectGarbage()
activate c1
c1--> s
deactivate c1


s -> c1: refuelShips()
activate c1
c1--> s
deactivate c1

s --> s
deactivate s

s -> s: driftGarbage()
activate s

s -> m: getTiles()
activate m

m --> s : List<Tile>
deactivate m

s -> oil: drift(t66)
activate oil

oil -> t66: getCurrent()
activate t66

t66 --> oil: current
deactivate t66

oil -> current: getIntensity()
activate current

current --> oil: 1



oil -> current: getSpeed()
current-> oil: 10

oil -> current: getDirection()
current --> oil: 0
deactivate current
oil -> t66: getTileInDirection(0,1)
activate t66

t66 --> oil: t67
deactivate t66

oil -> oil: splitGarbage(50)
activate oil
oil --> oil: newOil
deactivate oil
' Here the problem is: Current can drift more than 1 tile, but we call drift(t67,curr)
' without actually computing the destination tile, we just assume it goes there and then
' query getIntensity() and getSpeed() which makes no sense at this point.

oil -> t67: isDriftable(50)
activate t67

t67 --> oil: true




oil -> t67: driftGarbage(newOil)
t67 --> oil
deactivate t67

oil --> s
deactivate oil

s --> s
deactivate s


s -> s: driftShips()
activate s

s -> c1: getShips()
activate c1

c1 --> s: List<Ship>
deactivate c1
s -> scouting: drift()
activate scouting

scouting -> t66: getCurrent()
activate t66

t66 --> scouting: current
deactivate t66


scouting -> current: getIntensity()
activate current

current --> scouting: 1

scouting -> current: getSpeed()
current --> scouting: 10

scouting -> current: getDirection()
current --> scouting: 0
deactivate current

scouting -> t66: getTileInDirection(0,1)
activate t66

t66 -> scouting: t67
deactivate t66


scouting --> s
deactivate scouting

s --> s
deactivate s
s -> s: processEvents()
activate s
s --> s
deactivate s

s --> s
deactivate s

@enduml